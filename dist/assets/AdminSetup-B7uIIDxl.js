import{j as e}from"./index-CnSDPb6a.js";import{r as t}from"./vendor-seEwQDT5.js";import{L as u}from"./router-BnLuTL28.js";import{o as f,S as j,Q as x,E as y,r as w}from"./ui-zOJd_8GS.js";import"./supabase-BZoxqOT3.js";const A=()=>{const[s,p]=t.useState({email:"admin@3dsumisura.it",password:"admin123456",username:"admin",masterKey:"your-secret-master-key-2024"}),[l,i]=t.useState(!1),[h,o]=t.useState(!1),[d,m]=t.useState(""),r=a=>{p({...s,[a.target.name]:a.target.value})},b=async a=>{a.preventDefault(),i(!0),m(""),o(!1);try{const c=await fetch("https://ddmkhgobkzpwlmzgxuzc.supabase.co/functions/v1/create-admin",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRkbWtoZ29ia3pwd2xtemd4dXpjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk4MjczMzAsImV4cCI6MjA2NTQwMzMzMH0.DE0OQ4G93ognZuCH2z2rl-IdCy7ua1w_9bCYJuGJAwA"},body:JSON.stringify(s)}),g=await c.json();if(!c.ok)throw new Error(g.error||"Failed to create admin user");o(!0)}catch(n){m(n instanceof Error?n.message:"An error occurred")}finally{i(!1)}};return h?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-green-600 to-green-800 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"max-w-md w-full space-y-8",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-8 text-center",children:[e.jsx("div",{className:"bg-green-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(f,{className:"h-8 w-8 text-green-600"})}),e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Admin Creato!"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"L'utente amministratore è stato creato con successo. Ora puoi accedere al pannello di amministrazione."}),e.jsxs(u,{to:"/admin/login",className:"inline-flex items-center space-x-2 bg-blue-600 hover:bg-blue-700 text-white py-3 px-6 rounded-lg font-semibold transition-colors duration-200",children:[e.jsx(j,{className:"h-5 w-5"}),e.jsx("span",{children:"Vai al Login Admin"})]})]})})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-600 to-purple-800 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"bg-purple-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(x,{className:"h-8 w-8 text-purple-600"})}),e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Setup Admin"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Crea il primo utente amministratore"})]}),e.jsxs("form",{onSubmit:b,className:"space-y-6",children:[d&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start space-x-3",children:[e.jsx(y,{className:"h-5 w-5 text-red-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-red-800",children:"Errore"}),e.jsx("p",{className:"text-sm text-red-700",children:d})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Admin"}),e.jsx("input",{id:"email",name:"email",type:"email",required:!0,value:s.email,onChange:r,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),e.jsx("input",{id:"password",name:"password",type:"password",required:!0,value:s.password,onChange:r,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",minLength:8}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Minimo 8 caratteri"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),e.jsx("input",{id:"username",name:"username",type:"text",required:!0,value:s.username,onChange:r,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"masterKey",className:"block text-sm font-medium text-gray-700 mb-2",children:"Master Key"}),e.jsx("input",{id:"masterKey",name:"masterKey",type:"password",required:!0,value:s.masterKey,onChange:r,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Deve corrispondere alla chiave configurata in Supabase"})]}),e.jsx("button",{type:"submit",disabled:l,className:"w-full bg-purple-600 hover:bg-purple-700 disabled:bg-purple-400 text-white py-3 px-4 rounded-lg font-semibold transition-colors duration-200 flex items-center justify-center space-x-2",children:l?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e.jsx("span",{children:"Creazione in corso..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(x,{className:"h-5 w-5"}),e.jsx("span",{children:"Crea Admin"})]})})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs(u,{to:"/admin/login",className:"inline-flex items-center space-x-2 text-purple-600 hover:text-purple-700 text-sm font-medium",children:[e.jsx(w,{className:"h-4 w-4"}),e.jsx("span",{children:"Torna al Login"})]})})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-yellow-800 mb-2",children:"Importante"}),e.jsxs("p",{className:"text-sm text-yellow-700 mb-2",children:["Prima di procedere, assicurati che la variabile ",e.jsx("code",{className:"bg-yellow-100 px-1 rounded",children:"ADMIN_MASTER_KEY"}),"sia configurata nelle variabili d'ambiente delle Edge Functions di Supabase."]}),e.jsx("p",{className:"text-xs text-yellow-600",children:"Vai su: Project Settings → Edge Functions → Environment Variables"})]})]})})};export{A as default};
