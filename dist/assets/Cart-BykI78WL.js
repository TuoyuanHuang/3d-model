import{a as k,j as e}from"./index-CNRBJ32G.js";import{a as g}from"./vendor-seEwQDT5.js";import{L as r}from"./router-BnLuTL28.js";import{a as S,b as j,A as N,s as p,t as _,X as q,u as b,v as z,w as A,r as E}from"./ui-CrNHFUv9.js";import"./supabase-BZoxqOT3.js";const $=()=>{const{items:t,loading:f,totalAmount:n,updateQuantity:c,removeItem:i,clearCart:y}=k(),[o,d]=g.useState(null),[x,l]=g.useState(""),m=async(s,a)=>{a<1?await i(s):await c(s,a)},h=(s,a="")=>{d({itemId:s,note:a}),l(a)},u=()=>{d(null),l("")},v=async s=>{try{const a=t.find(C=>C.id===s);a&&(await c(s,a.quantity,x),u())}catch(a){console.error("Error updating note:",a)}},w=async()=>{window.confirm("Sei sicuro di voler svuotare il carrello?")&&await y()};return f?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Caricamento carrello..."})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 mb-2 flex items-center",children:[e.jsx(S,{className:"h-8 w-8 mr-3"}),"Il Mio Carrello"]}),e.jsx("p",{className:"text-gray-600",children:t.length===0?"Il tuo carrello è vuoto":`${t.length} ${t.length===1?"prodotto":"prodotti"} nel carrello`})]}),t.length===0?e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-8 text-center",children:[e.jsx(j,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Carrello Vuoto"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Non hai ancora aggiunto nessun prodotto al carrello"}),e.jsxs(r,{to:"/catalogo",className:"inline-flex items-center space-x-2 bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors",children:[e.jsx("span",{children:"Esplora il Catalogo"}),e.jsx(N,{className:"h-4 w-4"})]})]}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Prodotti"}),e.jsxs("button",{onClick:w,className:"text-red-600 hover:text-red-700 text-sm font-medium flex items-center space-x-1",children:[e.jsx(p,{className:"h-4 w-4"}),e.jsx("span",{children:"Svuota carrello"})]})]}),e.jsx("div",{className:"divide-y divide-gray-200",children:t.map(s=>e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-16 h-16 bg-gray-200 rounded-lg flex items-center justify-center",children:e.jsx(j,{className:"h-8 w-8 text-gray-400"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:s.product_name}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[s.selected_color&&e.jsxs("span",{className:"mr-3",children:["Colore: ",s.selected_color]}),s.selected_size&&e.jsxs("span",{children:["Dimensione: ",s.selected_size," ",s.size_dimensions&&`(${s.size_dimensions})`]})]}),o&&o.itemId===s.id?e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("textarea",{value:x,onChange:a=>l(a.target.value),className:"flex-1 text-sm p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",rows:2,placeholder:"Aggiungi una nota per questo prodotto..."}),e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("button",{onClick:()=>v(s.id),className:"p-1 text-green-600 hover:text-green-800",title:"Salva nota",children:e.jsx(_,{className:"h-4 w-4"})}),e.jsx("button",{onClick:u,className:"p-1 text-gray-600 hover:text-gray-800",title:"Annulla",children:e.jsx(q,{className:"h-4 w-4"})})]})]}):e.jsx("div",{className:"flex items-center text-sm",children:s.customer_note?e.jsxs("div",{className:"flex items-center text-gray-700",children:[e.jsx(b,{className:"h-4 w-4 mr-1 text-blue-600"}),e.jsx("span",{className:"mr-2",children:s.customer_note}),e.jsx("button",{onClick:()=>h(s.id,s.customer_note),className:"text-gray-500 hover:text-gray-700",title:"Modifica nota",children:e.jsx(z,{className:"h-3 w-3"})})]}):e.jsxs("button",{onClick:()=>h(s.id),className:"text-gray-500 hover:text-gray-700 flex items-center",children:[e.jsx(b,{className:"h-4 w-4 mr-1"}),e.jsx("span",{children:"Aggiungi nota"})]})})]}),e.jsxs("p",{className:"text-lg font-semibold text-blue-600",children:["€",s.unit_price.toFixed(2)]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>m(s.id,s.quantity-1),className:"w-8 h-8 rounded-full border border-gray-300 flex items-center justify-center hover:bg-gray-50 transition-colors",children:e.jsx(A,{className:"h-4 w-4"})}),e.jsx("span",{className:"font-medium text-gray-900 w-8 text-center",children:s.quantity}),e.jsx("button",{onClick:()=>m(s.id,s.quantity+1),className:"w-8 h-8 rounded-full border border-gray-300 flex items-center justify-center hover:bg-gray-50 transition-colors",children:e.jsx(E,{className:"h-4 w-4"})})]}),e.jsx("button",{onClick:()=>i(s.id),className:"text-red-600 hover:text-red-700 p-1",children:e.jsx(p,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"mt-4 text-right",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Subtotale: ",e.jsxs("span",{className:"font-medium text-gray-900",children:["€",(s.unit_price*s.quantity).toFixed(2)]})]})})]},s.id))})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 sticky top-24",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Riepilogo Ordine"}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Subtotale"}),e.jsxs("span",{className:"font-medium text-gray-900",children:["€",n.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Spedizione"}),e.jsx("span",{className:"font-medium text-gray-900",children:"Calcolata al checkout"})]}),e.jsx("div",{className:"border-t border-gray-200 pt-3",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-lg font-semibold text-gray-900",children:"Totale"}),e.jsxs("span",{className:"text-lg font-semibold text-blue-600",children:["€",n.toFixed(2)]})]})})]}),e.jsxs(r,{to:"/checkout",className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-3 px-4 rounded-lg font-semibold transition-colors duration-200 flex items-center justify-center space-x-2",children:[e.jsx("span",{children:"Procedi al Checkout"}),e.jsx(N,{className:"h-4 w-4"})]}),e.jsx(r,{to:"/catalogo",className:"block w-full text-center text-blue-600 hover:text-blue-700 font-medium mt-4",children:"Continua lo Shopping"})]})})]})]})})};export{$ as default};
