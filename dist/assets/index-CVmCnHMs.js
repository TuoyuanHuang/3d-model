const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Home-AUUCivep.js","assets/supabase-BZoxqOT3.js","assets/vendor-seEwQDT5.js","assets/router-BnLuTL28.js","assets/ui-g5MN1jGh.js","assets/products-D1xI0l5v.js","assets/About-DNcTMKnD.js","assets/Catalog-K2WqfFE_.js","assets/Contact-BqVbsTMs.js","assets/ProductDetail-DxbtZqvH.js","assets/CheckoutForm-K9o22ZuH.js","assets/stripe-rSCYVjF0.js","assets/LazyImage-Ni-_t8w0.js","assets/Cart-f_wPjF3F.js","assets/Checkout-CoGW56cc.js","assets/Orders-BZWVEKEQ.js","assets/OrderDetail-BKdM_Rs6.js","assets/Login-CvH88D8L.js","assets/Profile-5FJ6wCdb.js"])))=>i.map(i=>d[i]);
import{r as x,d as H,a as h}from"./vendor-seEwQDT5.js";import{c as W,_ as p}from"./supabase-BZoxqOT3.js";import{u as D,L as d,N as B,B as X,R as Y,a as u}from"./router-BnLuTL28.js";import{P as M,S as L,a as R,C as A,L as k,U as z,X as Z,M as Q,F as G,I as K,b as ee,c as te,d as se,e as re,f as ae}from"./ui-g5MN1jGh.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))o(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function a(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerPolicy&&(r.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?r.credentials="include":t.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(t){if(t.ep)return;t.ep=!0;const r=a(t);fetch(t.href,r)}})();var T={exports:{}},E={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oe=x,ne=Symbol.for("react.element"),ie=Symbol.for("react.fragment"),le=Object.prototype.hasOwnProperty,ce=oe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,de={key:!0,ref:!0,__self:!0,__source:!0};function V(n,s,a){var o,t={},r=null,c=null;a!==void 0&&(r=""+a),s.key!==void 0&&(r=""+s.key),s.ref!==void 0&&(c=s.ref);for(o in s)le.call(s,o)&&!de.hasOwnProperty(o)&&(t[o]=s[o]);if(n&&n.defaultProps)for(o in s=n.defaultProps,s)t[o]===void 0&&(t[o]=s[o]);return{$$typeof:ne,type:n,key:r,ref:c,props:t,_owner:ce.current}}E.Fragment=ie;E.jsx=V;E.jsxs=V;T.exports=E;var e=T.exports,$,S=H;$=S.createRoot,S.hydrateRoot;const xe="https://ddmkhgobkzpwlmzgxuzc.supabase.co",me="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRkbWtoZ29ia3pwd2xtemd4dXpjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk4MjczMzAsImV4cCI6MjA2NTQwMzMzMH0.DE0OQ4G93ognZuCH2z2rl-IdCy7ua1w_9bCYJuGJAwA",_=W(xe,me),F=x.createContext(void 0),O=()=>{const n=x.useContext(F);if(n===void 0)throw new Error("useAuth must be used within an AuthProvider");return n},ue=({children:n})=>{const[s,a]=x.useState(null),[o,t]=x.useState(null),[r,c]=x.useState(!0),f=async(i,j)=>{try{const{data:g,error:w}=await _.auth.signInWithPassword({email:i,password:j});return w?{error:w}:{error:null}}catch(g){return{error:g}}},y=async()=>{try{await _.auth.signOut()}catch{console.log("Session already invalid, clearing local state")}finally{a(null),t(null)}};x.useEffect(()=>{_.auth.getSession().then(({data:{session:j}})=>{t(j),a((j==null?void 0:j.user)??null),c(!1)});const{data:{subscription:i}}=_.auth.onAuthStateChange(async(j,g)=>{t(g),a((g==null?void 0:g.user)??null),c(!1)});return()=>i.unsubscribe()},[]);const b={user:s,session:o,loading:r,signIn:f,signOut:y,supabase:_};return e.jsx(F.Provider,{value:b,children:n})},J=x.createContext(void 0),he=()=>{const n=x.useContext(J);if(n===void 0)throw new Error("useCart must be used within a CartProvider");return n},pe=({children:n})=>{const[s,a]=x.useState([]),[o,t]=x.useState(!1),{user:r,supabase:c}=O(),f=async()=>{if(!r){a([]);return}try{t(!0);const{data:l,error:m}=await c.from("cart_items").select("*").order("created_at",{ascending:!1});if(m)throw m;a(l||[])}catch(l){console.error("Error loading cart:",l)}finally{t(!1)}},y=async(l,m,v,C=1,q)=>{if(!r)throw new Error("User must be logged in to add items to cart");try{t(!0);const{data:I,error:P}=await c.rpc("add_to_cart",{p_product_id:l,p_product_name:m,p_unit_price:v,p_quantity:C,p_selected_color:q});if(P)throw P;await f()}catch(I){throw console.error("Error adding to cart:",I),I}finally{t(!1)}},b=async(l,m)=>{try{t(!0);const{data:v,error:C}=await c.rpc("update_cart_item_quantity",{p_cart_item_id:l,p_quantity:m});if(C)throw C;await f()}catch(v){throw console.error("Error updating cart item:",v),v}finally{t(!1)}},i=async l=>{await b(l,0)},j=async()=>{try{t(!0);const{error:l}=await c.rpc("clear_user_cart");if(l)throw l;a([])}catch(l){throw console.error("Error clearing cart:",l),l}finally{t(!1)}};x.useEffect(()=>{f()},[r]);const g=s.reduce((l,m)=>l+m.quantity,0),w=s.reduce((l,m)=>l+m.unit_price*m.quantity,0),U={items:s,loading:o,totalItems:g,totalAmount:w,addToCart:y,updateQuantity:b,removeItem:i,clearCart:j,refreshCart:f};return e.jsx(J.Provider,{value:U,children:n})},fe=()=>{var b;const[n,s]=x.useState(!1),a=D(),{user:o,signOut:t}=O(),{totalItems:r}=he(),c=[{name:"Home",href:"/"},{name:"Catalogo",href:"/catalogo"},{name:"Chi Siamo",href:"/chi-siamo"},{name:"Contatti",href:"/contatti"}],f=i=>!!(i==="/"&&a.pathname==="/"||i!=="/"&&a.pathname.startsWith(i)),y=async()=>{await t(),s(!1)};return e.jsxs("header",{className:"bg-white shadow-sm sticky top-0 z-50",children:[e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsxs(d,{to:"/",className:"flex items-center space-x-2 text-2xl font-bold text-blue-600 hover:text-blue-700 transition-colors",children:[e.jsx(M,{className:"h-8 w-8"}),e.jsx("span",{children:"3D su Misura"})]}),e.jsxs("nav",{className:"hidden md:flex items-center space-x-8",children:[c.map(i=>e.jsx(d,{to:i.href,className:`px-3 py-2 text-sm font-medium transition-colors rounded-md ${f(i.href)?"text-blue-600 bg-blue-50":"text-gray-700 hover:text-blue-600 hover:bg-gray-50"}`,children:i.name},i.name)),o?e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(d,{to:"/carrello",className:`relative px-3 py-2 text-sm font-medium transition-colors rounded-md flex items-center space-x-1 ${a.pathname==="/carrello"?"text-blue-600 bg-blue-50":"text-gray-700 hover:text-blue-600 hover:bg-gray-50"}`,children:[e.jsx(L,{className:"h-4 w-4"}),e.jsx("span",{children:"Carrello"}),r>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:r})]}),e.jsxs(d,{to:"/ordini",className:`px-3 py-2 text-sm font-medium transition-colors rounded-md flex items-center space-x-1 ${a.pathname.startsWith("/ordini")?"text-blue-600 bg-blue-50":"text-gray-700 hover:text-blue-600 hover:bg-gray-50"}`,children:[e.jsx(R,{className:"h-4 w-4"}),e.jsx("span",{children:"Ordini"})]}),e.jsxs(d,{to:"/profilo",className:`px-3 py-2 text-sm font-medium transition-colors rounded-md flex items-center space-x-1 ${a.pathname==="/profilo"?"text-blue-600 bg-blue-50":"text-gray-700 hover:text-blue-600 hover:bg-gray-50"}`,children:[e.jsx(A,{className:"h-4 w-4"}),e.jsx("span",{children:"Profilo"})]}),e.jsxs("button",{onClick:y,className:"flex items-center space-x-1 px-3 py-2 text-sm font-medium text-gray-700 hover:text-red-600 hover:bg-gray-50 rounded-md transition-colors",children:[e.jsx(k,{className:"h-4 w-4"}),e.jsx("span",{children:"Esci"})]})]}):e.jsxs(d,{to:"/login",className:`px-3 py-2 text-sm font-medium transition-colors rounded-md flex items-center space-x-1 ${a.pathname==="/login"?"text-blue-600 bg-blue-50":"text-gray-700 hover:text-blue-600 hover:bg-gray-50"}`,children:[e.jsx(z,{className:"h-4 w-4"}),e.jsx("span",{children:"Accedi"})]})]}),e.jsx("button",{className:"md:hidden p-2 rounded-md text-gray-700 hover:text-blue-600 hover:bg-gray-100 transition-colors",onClick:()=>s(!n),children:n?e.jsx(Z,{className:"h-6 w-6"}):e.jsx(Q,{className:"h-6 w-6"})})]})}),n&&e.jsx("div",{className:"md:hidden bg-white border-t border-gray-200",children:e.jsxs("div",{className:"px-2 pt-2 pb-3 space-y-1",children:[c.map(i=>e.jsx(d,{to:i.href,className:`block px-3 py-2 text-base font-medium transition-colors rounded-md ${f(i.href)?"text-blue-600 bg-blue-50":"text-gray-700 hover:text-blue-600 hover:bg-gray-50"}`,onClick:()=>s(!1),children:i.name},i.name)),o?e.jsxs("div",{className:"border-t border-gray-200 pt-3 mt-3 space-y-1",children:[e.jsxs(d,{to:"/carrello",className:`block px-3 py-2 text-base font-medium transition-colors rounded-md flex items-center space-x-1 ${a.pathname==="/carrello"?"text-blue-600 bg-blue-50":"text-gray-700 hover:text-blue-600 hover:bg-gray-50"}`,onClick:()=>s(!1),children:[e.jsx(L,{className:"h-4 w-4"}),e.jsx("span",{children:"Carrello"}),r>0&&e.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center ml-auto",children:r})]}),e.jsxs(d,{to:"/ordini",className:`block px-3 py-2 text-base font-medium transition-colors rounded-md flex items-center space-x-1 ${a.pathname.startsWith("/ordini")?"text-blue-600 bg-blue-50":"text-gray-700 hover:text-blue-600 hover:bg-gray-50"}`,onClick:()=>s(!1),children:[e.jsx(R,{className:"h-4 w-4"}),e.jsx("span",{children:"Ordini"})]}),e.jsxs(d,{to:"/profilo",className:`block px-3 py-2 text-base font-medium transition-colors rounded-md flex items-center space-x-1 ${a.pathname==="/profilo"?"text-blue-600 bg-blue-50":"text-gray-700 hover:text-blue-600 hover:bg-gray-50"}`,onClick:()=>s(!1),children:[e.jsx(A,{className:"h-4 w-4"}),e.jsx("span",{children:"Profilo"})]}),e.jsxs("div",{className:"px-3 py-2 text-sm text-gray-600",children:["Ciao, ",((b=o.user_metadata)==null?void 0:b.full_name)||o.email]}),e.jsxs("button",{onClick:y,className:"block w-full text-left px-3 py-2 text-base font-medium text-gray-700 hover:text-red-600 hover:bg-gray-50 rounded-md transition-colors flex items-center space-x-1",children:[e.jsx(k,{className:"h-4 w-4"}),e.jsx("span",{children:"Esci"})]})]}):e.jsx("div",{className:"border-t border-gray-200 pt-3 mt-3",children:e.jsxs(d,{to:"/login",className:`block px-3 py-2 text-base font-medium transition-colors rounded-md flex items-center space-x-1 ${a.pathname==="/login"?"text-blue-600 bg-blue-50":"text-gray-700 hover:text-blue-600 hover:bg-gray-50"}`,onClick:()=>s(!1),children:[e.jsx(z,{className:"h-4 w-4"}),e.jsx("span",{children:"Accedi"})]})})]})})]})},je=()=>e.jsx("footer",{className:"bg-gray-900 text-white",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[e.jsxs("div",{className:"col-span-1 md:col-span-2",children:[e.jsxs(d,{to:"/",className:"flex items-center space-x-2 text-2xl font-bold mb-4",children:[e.jsx(M,{className:"h-8 w-8 text-blue-400"}),e.jsx("span",{children:"3D su Misura"})]}),e.jsx("p",{className:"text-gray-300 mb-6 max-w-md",children:"Specializziamo nella stampa 3D professionale di alta qualità. Dalla prototipazione rapida agli oggetti personalizzati, trasformiamo le tue idee in realtà."}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("a",{href:"#",className:"text-gray-400 hover:text-blue-400 transition-colors",children:e.jsx(G,{className:"h-6 w-6"})}),e.jsx("a",{href:"#",className:"text-gray-400 hover:text-blue-400 transition-colors",children:e.jsx(K,{className:"h-6 w-6"})}),e.jsx("a",{href:"#",className:"text-gray-400 hover:text-blue-400 transition-colors",children:e.jsx(ee,{className:"h-6 w-6"})})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Link Rapidi"}),e.jsxs("ul",{className:"space-y-2",children:[e.jsx("li",{children:e.jsx(d,{to:"/",className:"text-gray-300 hover:text-white transition-colors",children:"Home"})}),e.jsx("li",{children:e.jsx(d,{to:"/catalogo",className:"text-gray-300 hover:text-white transition-colors",children:"Catalogo"})}),e.jsx("li",{children:e.jsx(d,{to:"/chi-siamo",className:"text-gray-300 hover:text-white transition-colors",children:"Chi Siamo"})}),e.jsx("li",{children:e.jsx(d,{to:"/contatti",className:"text-gray-300 hover:text-white transition-colors",children:"Contatti"})})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Contatti"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(te,{className:"h-5 w-5 text-blue-400"}),e.jsx("span",{className:"text-gray-300",children:"info@3dsumisura.it"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(se,{className:"h-5 w-5 text-blue-400"}),e.jsx("span",{className:"text-gray-300",children:"+39 123 456 7890"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(re,{className:"h-5 w-5 text-blue-400"}),e.jsx("span",{className:"text-gray-300",children:"Via Roma 123, Milano"})]})]})]})]}),e.jsx("div",{className:"border-t border-gray-800 mt-8 pt-8 text-center text-gray-400",children:e.jsxs("p",{children:["© ",new Date().getFullYear()," 3D su Misura. Tutti i diritti riservati."]})})]})}),N=({children:n})=>{const{user:s,loading:a}=O(),o=D();return a?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Caricamento..."})]})}):s?e.jsx(e.Fragment,{children:n}):e.jsx(B,{to:"/login",state:{from:o},replace:!0})},ge=()=>e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ae,{className:"h-12 w-12 animate-spin text-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Caricamento..."})]})}),be=h.lazy(()=>p(()=>import("./Home-AUUCivep.js"),__vite__mapDeps([0,1,2,3,4,5]))),ye=h.lazy(()=>p(()=>import("./About-DNcTMKnD.js"),__vite__mapDeps([6,4,2,1,3]))),ve=h.lazy(()=>p(()=>import("./Catalog-K2WqfFE_.js"),__vite__mapDeps([7,1,2,5,4,3]))),_e=h.lazy(()=>p(()=>import("./Contact-BqVbsTMs.js"),__vite__mapDeps([8,2,4,1,3]))),Ne=h.lazy(()=>p(()=>import("./ProductDetail-DxbtZqvH.js"),__vite__mapDeps([9,2,3,10,11,4,12,5,1]))),we=h.lazy(()=>p(()=>import("./Cart-f_wPjF3F.js"),__vite__mapDeps([13,3,2,4,1]))),Ce=h.lazy(()=>p(()=>import("./Checkout-CoGW56cc.js"),__vite__mapDeps([14,2,10,11,4,3,1]))),Ee=h.lazy(()=>p(()=>import("./Orders-BZWVEKEQ.js"),__vite__mapDeps([15,2,3,4,1]))),Ie=h.lazy(()=>p(()=>import("./OrderDetail-BKdM_Rs6.js"),__vite__mapDeps([16,2,3,4,1]))),Oe=h.lazy(()=>p(()=>import("./Login-CvH88D8L.js"),__vite__mapDeps([17,2,3,4,1]))),Pe=h.lazy(()=>p(()=>import("./Profile-5FJ6wCdb.js"),__vite__mapDeps([18,2,4,1,3])));function Le(){return e.jsx(ue,{children:e.jsx(pe,{children:e.jsx(X,{children:e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[e.jsx(fe,{}),e.jsx("main",{className:"flex-grow",children:e.jsx(x.Suspense,{fallback:e.jsx(ge,{}),children:e.jsxs(Y,{children:[e.jsx(u,{path:"/",element:e.jsx(be,{})}),e.jsx(u,{path:"/chi-siamo",element:e.jsx(ye,{})}),e.jsx(u,{path:"/catalogo",element:e.jsx(ve,{})}),e.jsx(u,{path:"/contatti",element:e.jsx(_e,{})}),e.jsx(u,{path:"/prodotto/:id",element:e.jsx(Ne,{})}),e.jsx(u,{path:"/login",element:e.jsx(Oe,{})}),e.jsx(u,{path:"/carrello",element:e.jsx(N,{children:e.jsx(we,{})})}),e.jsx(u,{path:"/checkout",element:e.jsx(N,{children:e.jsx(Ce,{})})}),e.jsx(u,{path:"/ordini",element:e.jsx(N,{children:e.jsx(Ee,{})})}),e.jsx(u,{path:"/ordini/:orderId",element:e.jsx(N,{children:e.jsx(Ie,{})})}),e.jsx(u,{path:"/profilo",element:e.jsx(N,{children:e.jsx(Pe,{})})})]})})}),e.jsx(je,{})]})})})})}$(document.getElementById("root")).render(e.jsx(x.StrictMode,{children:e.jsx(Le,{})}));export{he as a,e as j,O as u};
