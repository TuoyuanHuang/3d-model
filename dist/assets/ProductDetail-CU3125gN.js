import{u as _,a as B,j as e}from"./index-CbLxj3tM.js";import{r as n}from"./vendor-seEwQDT5.js";import{b as H,c as O,L as h}from"./router-BnLuTL28.js";import{C as V}from"./CheckoutForm-BpLIvd0A.js";import{L as N}from"./LazyImage-CsJ7Fyhr.js";import{p as y}from"./products-BlAzMjlO.js";import{r as v,b as z,s as G,R as J,t as K,u as U,a as W,d as X,e as Y}from"./ui-Crfp5dSv.js";import"./supabase-BZoxqOT3.js";import"./stripe-rSCYVjF0.js";const ce=()=>{var F;const{id:A}=H(),g=O(),{user:t,session:u}=_(),{addToCart:M,loading:w}=B(),s=y.products.find(a=>a.id===A),[C,k]=n.useState(0),[p,T]=n.useState(0),[j,E]=n.useState(0),[r,S]=n.useState(1),[I,P]=n.useState(!1),[D,b]=n.useState(!1),[i,q]=n.useState({name:((F=t==null?void 0:t.user_metadata)==null?void 0:F.full_name)||"",email:(t==null?void 0:t.email)||"",phone:"",address:"",city:"",postalCode:""});if(n.useEffect(()=>{k(0)},[p]),!s)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Prodotto non trovato"}),e.jsxs(h,{to:"/catalogo",className:"text-blue-600 hover:text-blue-700 font-medium flex items-center justify-center space-x-2",children:[e.jsx(v,{className:"h-4 w-4"}),e.jsx("span",{children:"Torna al catalogo"})]})]})});const f=y.categories.find(a=>a.id===s.category),m=y.materials.find(a=>a.id===s.material),x=s.basePrice+s.sizes[j].priceModifier,c=s.colors[p],d=s.sizes[j],L=async()=>{if(!t){g("/login");return}try{P(!0),await M(s.id,s.name,x,r,c.name,d.name,d.dimensions)}catch(a){console.error("Error adding to cart:",a)}finally{P(!1)}},R=()=>{if(!t){g("/login");return}b(!0)},$=a=>{g(`/ordini/${a}`)},Q=a=>{console.error("Payment error:",a),b(!1)},o=a=>{q({...i,[a.target.name]:a.target.value})};return D?e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("button",{onClick:()=>b(!1),className:"inline-flex items-center space-x-2 text-blue-600 hover:text-blue-700 font-medium mb-4",children:[e.jsx(v,{className:"h-4 w-4"}),e.jsx("span",{children:"Torna al prodotto"})]}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Checkout"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Completa il tuo acquisto"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center",children:[e.jsx(z,{className:"h-5 w-5 mr-2"}),"Riepilogo Prodotto"]}),e.jsxs("div",{className:"flex space-x-4 mb-6",children:[e.jsx(N,{src:c.images[0],alt:s.name,className:"w-20 h-20 object-cover rounded-lg"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:s.name}),e.jsx("p",{className:"text-gray-600 text-sm",children:s.description}),e.jsxs("p",{className:"text-lg font-bold text-blue-600 mt-2",children:["€",x.toFixed(2)]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Colore: "}),e.jsx("span",{className:"font-medium",children:c.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Dimensione: "}),e.jsxs("span",{className:"font-medium",children:[d.name," (",d.dimensions,")"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Quantità: "}),e.jsx("span",{className:"font-medium",children:r})]}),e.jsx("div",{className:"border-t pt-4",children:e.jsxs("div",{className:"flex justify-between items-center text-lg font-semibold",children:[e.jsx("span",{children:"Totale:"}),e.jsxs("span",{className:"text-blue-600",children:["€",(x*r).toFixed(2)]})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Informazioni di Pagamento"}),e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome Completo *"}),e.jsx("input",{type:"text",id:"name",name:"name",required:!0,value:i.name,onChange:o,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Mario Rossi"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),e.jsx("input",{type:"email",id:"email",name:"email",required:!0,value:i.email,onChange:o,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"mario@email.com"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Telefono"}),e.jsx("input",{type:"tel",id:"phone",name:"phone",value:i.phone,onChange:o,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"+39 123 456 7890"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700 mb-1",children:"Indirizzo"}),e.jsx("input",{type:"text",id:"address",name:"address",value:i.address,onChange:o,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Via Roma 123"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"city",className:"block text-sm font-medium text-gray-700 mb-1",children:"Città"}),e.jsx("input",{type:"text",id:"city",name:"city",value:i.city,onChange:o,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Milano"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"postalCode",className:"block text-sm font-medium text-gray-700 mb-1",children:"CAP"}),e.jsx("input",{type:"text",id:"postalCode",name:"postalCode",value:i.postalCode,onChange:o,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"20121"})]})]})]}),e.jsx(V,{amount:x*r,productName:s.name,productId:s.id,selectedColor:c.name,selectedSize:d.name,sizeDimensions:d.dimensions,quantity:r,customerInfo:i,authToken:u==null?void 0:u.access_token,onSuccess:$,onError:Q})]})]})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("nav",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx(h,{to:"/",className:"hover:text-blue-600",children:"Home"}),e.jsx("span",{children:"/"}),e.jsx(h,{to:"/catalogo",className:"hover:text-blue-600",children:"Catalogo"}),e.jsx("span",{children:"/"}),e.jsx("span",{className:"text-gray-900",children:s.name})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"aspect-square bg-white rounded-lg overflow-hidden shadow-sm",children:e.jsx(N,{src:c.images[C],alt:s.name,className:"w-full h-full object-cover"})}),c.images.length>1&&e.jsx("div",{className:"flex space-x-2",children:c.images.map((a,l)=>e.jsx("button",{onClick:()=>k(l),className:`w-20 h-20 rounded-lg overflow-hidden border-2 transition-colors ${C===l?"border-blue-500":"border-gray-200"}`,children:e.jsx(N,{src:a,alt:`${s.name} ${l+1}`,className:"w-full h-full object-cover"})},l))})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[s.featured&&e.jsxs("div",{className:"inline-flex items-center space-x-1 bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium mb-2",children:[e.jsx(G,{className:"h-4 w-4 fill-current"}),e.jsx("span",{children:"In Evidenza"})]}),e.jsx("h1",{className:"text-3xl lg:text-4xl font-bold text-gray-900 mb-2",children:s.name}),e.jsx("p",{className:"text-xl text-gray-600 mb-4",children:f==null?void 0:f.name}),e.jsxs("div",{className:"text-3xl font-bold text-blue-600",children:["€",x.toFixed(2)]})]}),e.jsx("div",{className:"prose prose-gray max-w-none",children:e.jsx("p",{children:s.description})}),e.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Specifiche Tecniche"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(z,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Materiale"}),e.jsx("p",{className:"font-medium",children:m==null?void 0:m.name})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(J,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Dimensioni"}),e.jsx("p",{className:"font-medium",children:d.dimensions})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(K,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Colori disponibili"}),e.jsx("p",{className:"font-medium",children:s.colors.length})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Dimensioni"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.sizes.map((a,l)=>e.jsxs("button",{onClick:()=>E(l),className:`px-4 py-2 rounded-full border-2 text-sm font-medium transition-colors ${j===l?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-300 bg-white text-gray-700 hover:border-gray-400"}`,children:[e.jsx("span",{className:"block",children:a.name}),e.jsx("span",{className:"text-xs text-gray-500",children:a.dimensions}),a.priceModifier>0&&e.jsxs("span",{className:"text-xs text-gray-500",children:["+€",a.priceModifier.toFixed(2)]})]},l))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Colori Disponibili"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.colors.map((a,l)=>e.jsx("button",{onClick:()=>T(l),className:`px-4 py-2 rounded-full border-2 text-sm font-medium transition-colors ${p===l?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-300 bg-white text-gray-700 hover:border-gray-400"}`,children:a.name},l))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Quantità"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:()=>S(Math.max(1,r-1)),className:"w-10 h-10 rounded-full border border-gray-300 flex items-center justify-center hover:bg-gray-50 transition-colors",children:"-"}),e.jsx("span",{className:"font-medium text-gray-900 w-12 text-center text-lg",children:r}),e.jsx("button",{onClick:()=>S(r+1),className:"w-10 h-10 rounded-full border border-gray-300 flex items-center justify-center hover:bg-gray-50 transition-colors",children:"+"})]})]}),s.features&&s.features.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Caratteristiche"}),e.jsx("ul",{className:"space-y-2",children:s.features.map((a,l)=>e.jsxs("li",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full"}),e.jsx("span",{className:"text-gray-700",children:a})]},l))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx("button",{onClick:L,disabled:I||w,className:"bg-gray-100 hover:bg-gray-200 disabled:bg-gray-300 text-gray-700 py-3 px-4 rounded-lg font-semibold transition-colors duration-200 flex items-center justify-center space-x-2",children:I?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-gray-600"}),e.jsx("span",{children:"Aggiunta..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"h-5 w-5"}),e.jsx("span",{children:"Aggiungi al Carrello"})]})}),e.jsxs("button",{onClick:R,disabled:w,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white py-3 px-4 rounded-lg font-semibold transition-colors duration-200 flex items-center justify-center space-x-2",children:[e.jsx(W,{className:"h-5 w-5"}),e.jsx("span",{children:"Acquista Ora"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-gray-100 text-gray-700 py-3 px-4 rounded-lg font-medium flex items-center justify-center space-x-2",children:[e.jsx(X,{className:"h-4 w-4"}),e.jsx("span",{children:"info@3dsumisura.it"})]}),e.jsxs("div",{className:"bg-gray-100 text-gray-700 py-3 px-4 rounded-lg font-medium flex items-center justify-center space-x-2",children:[e.jsx(Y,{className:"h-4 w-4"}),e.jsx("span",{children:"+39 123 456 7890"})]})]})]}),m&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Informazioni sul Materiale"}),e.jsx("p",{className:"text-sm text-gray-600",children:m.description})]})]})]}),e.jsx("div",{className:"mt-12 text-center",children:e.jsxs(h,{to:"/catalogo",className:"inline-flex items-center space-x-2 text-blue-600 hover:text-blue-700 font-medium",children:[e.jsx(v,{className:"h-4 w-4"}),e.jsx("span",{children:"Torna al Catalogo"})]})})]})})};export{ce as default};
