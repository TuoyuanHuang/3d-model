import{u as p,a as j,j as e,V as m}from"./index-DFTuakBc.js";import{r as x}from"./vendor-seEwQDT5.js";import{L as n}from"./router-BnLuTL28.js";import{L as y}from"./LazyImage-BPD0pW09.js";import{s as v,a1 as N,u as w}from"./ui-zOJd_8GS.js";import"./supabase-BZoxqOT3.js";const I=({product:a})=>{const{user:h}=p(),{addToCart:g}=j(),[o,u]=x.useState(0),[t,d]=x.useState(!1),l=a.sizes[0],c=a.basePrice+l.priceModifier,i=a.colors[o],f=async s=>{if(s.preventDefault(),s.stopPropagation(),!h){window.location.href="/login";return}try{d(!0),await g(a.id,a.name,c,1,i.name,l.name,l.dimensions,void 0),m.success(e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:a.name})," aggiunto al carrello!"]}),{icon:"ðŸ›’",position:"bottom-right",duration:2e3,style:{background:"#10B981",color:"#fff"}})}catch(r){console.error("Error adding to cart:",r),m.error("Errore durante l'aggiunta al carrello. Riprova.",{position:"bottom-right",duration:3e3,style:{background:"#EF4444",color:"#fff"}})}finally{setTimeout(()=>d(!1),500)}};return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm hover:shadow-md transition-shadow duration-300 overflow-hidden group",children:[e.jsxs("div",{className:"relative overflow-hidden",children:[e.jsx(n,{to:`/prodotto/${a.id}`,"aria-label":`Vai alla pagina dettagli di ${a.name}`,children:e.jsx(y,{src:i.images[0],alt:a.name,className:"w-full h-48 object-cover group-hover:scale-105 transition-transform duration-300",width:320,height:192})}),a.featured&&e.jsxs("div",{className:"absolute top-3 left-3 bg-blue-600 text-white px-2 py-1 rounded-full text-xs font-medium flex items-center space-x-1",children:[e.jsx(v,{className:"h-3 w-3 fill-current"}),e.jsx("span",{children:"In Evidenza"})]}),e.jsxs("div",{className:"absolute top-3 right-3 bg-white bg-opacity-90 backdrop-blur-sm rounded-full px-2 py-1 text-xs font-medium text-gray-700",children:["â‚¬",c.toFixed(2)]})]}),e.jsxs("div",{className:"p-4",children:[e.jsx(n,{to:`/prodotto/${a.id}`,"aria-label":`Vai alla pagina dettagli di ${a.name}`,children:e.jsx("h3",{className:"font-semibold text-gray-900 mb-2 line-clamp-2 hover:text-blue-600 transition-colors",children:a.name})}),e.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:a.description}),e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded-full",children:a.material.toUpperCase()}),e.jsx("span",{className:"text-xs text-gray-500",children:a.sizes[0].dimensions})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Colore:"}),e.jsx("span",{className:"text-xs font-medium text-gray-700",children:i.name})]}),e.jsxs("div",{className:"flex space-x-1",children:[a.colors.slice(0,4).map((s,r)=>e.jsx("button",{onClick:b=>{b.preventDefault(),u(r)},className:`w-6 h-6 rounded-full border-2 transition-all ${o===r?"border-blue-500 scale-110":"border-gray-300 hover:border-gray-400"}`,title:s.name,"aria-label":`Seleziona colore ${s.name}`,style:{backgroundColor:s.hexCode||"#ccc"}},r)),a.colors.length>4&&e.jsxs("span",{className:"text-xs text-gray-500 ml-1 flex items-center",children:["+",a.colors.length-4]})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(n,{to:`/prodotto/${a.id}`,className:"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 py-2 px-4 rounded-lg font-medium transition-colors duration-200 flex items-center justify-center space-x-2","aria-label":`Vedi dettagli di ${a.name}`,children:[e.jsx(N,{className:"h-4 w-4"}),e.jsx("span",{children:"Dettagli"})]}),e.jsx("button",{onClick:f,disabled:t,"aria-label":`Aggiungi ${a.name} al carrello`,"aria-busy":t,className:`flex-1 py-2 px-4 rounded-lg font-medium transition-colors duration-200 flex items-center justify-center space-x-2 ${t?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current","aria-hidden":"true"}),e.jsx("span",{children:"Aggiungendo..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"h-4 w-4","aria-hidden":"true"}),e.jsx("span",{children:"Carrello"})]})})]})]})]})};export{I as default};
