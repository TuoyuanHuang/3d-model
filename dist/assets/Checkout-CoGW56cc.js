import{u as j,a as y,j as e}from"./index-CVmCnHMs.js";import{r as n}from"./vendor-seEwQDT5.js";import{C as N}from"./CheckoutForm-K9o22ZuH.js";import{c as v}from"./router-BnLuTL28.js";import{a as m,x as C,y as w,U as k}from"./ui-g5MN1jGh.js";import"./supabase-BZoxqOT3.js";import"./stripe-rSCYVjF0.js";const q=()=>{var d;const{user:t,session:i}=j(),{items:r,totalAmount:c,clearCart:x}=y(),o=v(),[a,u]=n.useState({name:((d=t==null?void 0:t.user_metadata)==null?void 0:d.full_name)||"",email:(t==null?void 0:t.email)||"",phone:"",address:"",city:"",postalCode:""}),[g,h]=n.useState(!1);n.useEffect(()=>{r.length===0&&o("/carrello")},[r,o]),n.useEffect(()=>{const s=a.name.trim()!==""&&a.email.trim()!=="";h(s)},[a]);const l=s=>{u({...a,[s.target.name]:s.target.value})},p=async s=>{try{await x(),o(`/ordini/${s}`)}catch(f){console.error("Error clearing cart:",f),o(`/ordini/${s}`)}},b=s=>{console.error("Payment error:",s)};return r.length===0?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(m,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Carrello Vuoto"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Aggiungi prodotti al carrello per procedere al checkout"}),e.jsx("button",{onClick:()=>o("/catalogo"),className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium",children:"Vai al Catalogo"})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Checkout"}),e.jsx("p",{className:"text-gray-600",children:"Completa il tuo ordine con pagamento sicuro"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center",children:[e.jsx(m,{className:"h-5 w-5 mr-2"}),"Riepilogo Ordine"]}),e.jsx("div",{className:"space-y-4 mb-6",children:r.map(s=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:s.product_name}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsxs("span",{children:["Quantità: ",s.quantity]}),s.selected_color&&e.jsxs("span",{className:"ml-4",children:["Colore: ",s.selected_color]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-medium text-gray-900",children:["€",s.unit_price.toFixed(2)]}),s.quantity>1&&e.jsxs("p",{className:"text-sm text-gray-600",children:["€",(s.unit_price*s.quantity).toFixed(2)," totale"]})]})]},s.id))}),e.jsx("div",{className:"border-t border-gray-200 pt-4",children:e.jsxs("div",{className:"flex justify-between items-center text-lg font-semibold",children:[e.jsx("span",{children:"Totale:"}),e.jsxs("span",{className:"text-blue-600",children:["€",c.toFixed(2)]})]})}),e.jsxs("div",{className:"mt-6 bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(C,{className:"h-5 w-5 text-green-600"}),e.jsx("span",{className:"font-medium text-green-800",children:"Pagamento Sicuro"})]}),e.jsx("p",{className:"text-sm text-green-700",children:"I tuoi dati sono protetti con crittografia SSL a 256 bit"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center",children:[e.jsx(w,{className:"h-5 w-5 mr-2"}),"Pagamento"]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[e.jsx(k,{className:"h-5 w-5 mr-2"}),"Informazioni Cliente"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome Completo *"}),e.jsx("input",{type:"text",id:"name",name:"name",required:!0,value:a.name,onChange:l,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Mario Rossi"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),e.jsx("input",{type:"email",id:"email",name:"email",required:!0,value:a.email,onChange:l,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"mario@email.com"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Telefono"}),e.jsx("input",{type:"tel",id:"phone",name:"phone",value:a.phone,onChange:l,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"+39 123 456 7890"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700 mb-1",children:"Indirizzo"}),e.jsx("input",{type:"text",id:"address",name:"address",value:a.address,onChange:l,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Via Roma 123"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"city",className:"block text-sm font-medium text-gray-700 mb-1",children:"Città"}),e.jsx("input",{type:"text",id:"city",name:"city",value:a.city,onChange:l,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Milano"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"postalCode",className:"block text-sm font-medium text-gray-700 mb-1",children:"CAP"}),e.jsx("input",{type:"text",id:"postalCode",name:"postalCode",value:a.postalCode,onChange:l,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"20121"})]})]})]}),g?e.jsx(N,{amount:c,productName:`Ordine carrello (${r.length} ${r.length===1?"prodotto":"prodotti"})`,productId:"cart-order",cartItems:r,customerInfo:a,authToken:i==null?void 0:i.access_token,onSuccess:p,onError:b}):e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-yellow-800 font-medium",children:"Completa le informazioni obbligatorie per procedere al pagamento"}),e.jsx("p",{className:"text-yellow-700 text-sm mt-1",children:"I campi Nome e Email sono obbligatori"})]})]})]})]})})};export{q as default};
